%l_returnflagl_linestatussum(l_quantity)assum_qtysum(l_extendedprice)assum_base_pricesum(l_extendedprice*(1-l_discount))assum_disc_pricesum(l_extendedprice*(1-l_discount)*(1+l_tax))assum_chargeavg(l_quantity)asavg_qtyavg(l_extendedprice)asavg_priceavg(l_discount)asavg_disccount(*)ascount_order%lineitemwherel_shipdate<=date'1998-12-01'-interval'3day'%%l_returnflagl_linestatus%%l_returnflagl_linestatusLIMIT1;%s_acctbals_namen_namep_partkeyp_mfgrs_addresss_phones_comment%partsupplierpartsuppnationregionwherep_partkey=ps_partkeyands_suppkey=ps_suppkeyandp_size=1andp_type%'%STEEL'ands_nationkey=n_nationkeyandn_regionkey=r_regionkeyandr_name='ASIA'andps_supplycost=(%min(ps_supplycost)%partsuppsuppliernationregionwherep_partkey=ps_partkeyands_suppkey=ps_suppkeyands_nationkey=n_nationkeyandn_regionkey=r_regionkeyandr_name='ASIA')%%s_acctbaldescn_names_namep_partkeyLIMIT1;%l_orderkeysum(l_extendedprice*(1-l_discount))asrevenueo_orderdateo_shippriority%customerorderslineitemwherec_mktsegment='AUTOMOBILE'andc_custkey=o_custkeyandl_orderkey=o_orderkeyando_orderdate<date'1995-03-01'andl_shipdate>date'1995-03-01'%%l_orderkeyo_orderdateo_shippriority%%revenuedesco_orderdateLIMIT1;%o_orderprioritycount(*)asorder_count%orderswhereo_orderdate>=date'1995-03-01'ando_orderdate<date'1995-03-01'+interval'3month'and%(%*%lineitemwherel_orderkey=o_orderkeyandl_commitdate<l_receiptdate)%%o_orderpriority%%o_orderpriorityLIMIT1;%n_namesum(l_extendedprice*(1-l_discount))asrevenue%customerorderslineitemsuppliernationregionwherec_custkey=o_custkeyandl_orderkey=o_orderkeyandl_suppkey=s_suppkeyandc_nationkey=s_nationkeyands_nationkey=n_nationkeyandn_regionkey=r_regionkeyandr_name='AISA'ando_orderdate>=date'1995-03-01'ando_orderdate<date'1995-03-01'+interval'1year'%%n_name%%revenuedescLIMIT1;%sum(l_extendedprice*l_discount)asrevenue%lineitemwherel_shipdate>=date'1995-03-01'andl_shipdate<date'1995-03-01'+interval'1year'andl_discountbetween0.05-0.01and0.05+0.01andl_quantity<25.00LIMIT1;%supp_nationcust_nationl_yearsum(volume)asrevenue%(%n1.n_nameassupp_nationn2.n_nameascust_nationl_extendedprice*(1-l_discount)asvolume%supplierlineitemorderscustomernationn1nationn2wheres_suppkey=l_suppkeyando_orderkey=l_orderkeyandc_custkey=o_custkeyands_nationkey=n1.n_nationkeyandc_nationkey=n2.n_nationkeyand((n1.n_name='GERMANY'andn2.n_name='BRAZIL')or(n1.n_name='BRAZIL'andn2.n_name='GERMANY'))andl_shipdatebetweendate'1995-01-01'anddate'1996-12-31')asshipping%%supp_nationcust_nationl_year%%supp_nationcust_nationl_yearLIMIT1;%o_yearsum(casewhennation='GERMANY'thenvolumeelse0end)/sum(volume)asmkt_share%(%l_extendedprice*(1-l_discount)asvolumen2.n_nameasnation%partsupplierlineitemorderscustomernationn1nationn2regionwherep_partkey=l_partkeyands_suppkey=l_suppkeyandl_orderkey=o_orderkeyando_custkey=c_custkeyandc_nationkey=n1.n_nationkeyandn1.n_regionkey=r_regionkeyandr_name='ASIA'ands_nationkey=n2.n_nationkeyando_orderdatebetweendate'1995-01-01'anddate'1996-12-31'andp_type='STANDARDBRUSHEDTIN')asall_nations%%o_year%%o_yearLIMIT1;%nationo_yearsum(amount)assum_profit%(%n_nameasnationl_extendedprice*(1-l_discount)-ps_supplycost*l_quantityasamount%partsupplierlineitempartsuppordersnationwheres_suppkey=l_suppkeyandps_suppkey=l_suppkeyandps_partkey=l_partkeyandp_partkey=l_partkeyando_orderkey=l_orderkeyands_nationkey=n_nationkeyandp_name%'%lemon%')asprofit%%nationo_year%%nationo_yeardescLIMIT1;%c_custkeyc_namesum(l_extendedprice*(1-l_discount))asrevenue--c_acctbal--n_name--c_address--c_phone--c_comment%customerorderslineitemnationwherec_custkey=o_custkeyandl_orderkey=o_orderkeyando_orderdate>=date'1995-03-01'ando_orderdate<date'1995-03-01'+interval'3'monthandl_returnflag='R'andc_nationkey=n_nationkey%%c_custkeyc_namec_acctbalc_phonen_namec_addressc_comment%%revenuedescLIMIT1;%ps_partkeysum(ps_supplycost*ps_availqty)asvalue%partsuppsuppliernationwhereps_suppkey=s_suppkeyands_nationkey=n_nationkeyandn_name='GERMANY'%%ps_partkeyhavingsum(ps_supplycost*ps_availqty)>(%sum(ps_supplycost*ps_availqty)*0.00004%partsuppsuppliernationwhereps_suppkey=s_suppkeyands_nationkey=n_nationkeyandn_name='GERMANY')%%valuedescLIMIT1;%l_shipmodesum(casewheno_orderpriority='1-URGENT'oro_orderpriority='2-HIGH'then1else0end)ashigh_line_countsum(casewheno_orderpriority<>'1-URGENT'ando_orderpriority<>'2-HIGH'then1else0end)aslow_line_count%orderslineitemwhereo_orderkey=l_orderkeyandl_shipmode%('RAIL''TRUCK')andl_commitdate<l_receiptdateandl_shipdate<l_commitdateandl_receiptdate>=date'1995-03-01'andl_receiptdate<date'1995-03-01'+interval'1'year%%l_shipmode%%l_shipmodeLIMIT1;%c_countcount(*)ascustdist%(%c_custkeycount(o_orderkey)%customer%%%ordersonc_custkey=o_custkeyando_commentnot%'%the%regular%'%%c_custkey)asc_orders(c_custkeyc_count)%%c_count%%custdistdescc_countdescLIMIT1;%100.00*sum(casewhenp_type%'PROMO%'thenl_extendedprice*(1-l_discount)else0end)/sum(l_extendedprice*(1-l_discount))aspromo_revenue%lineitempartwherel_partkey=p_partkeyandl_shipdate>=date'1995-03-01'andl_shipdate<date'1995-03-01'+interval'1'monthLIMIT1;%p_brandp_typep_sizecount(distinctps_suppkey)assupplier_cnt%partsupppartwherep_partkey=ps_partkeyandp_brand<>'Brand#50'andp_typenot%'LARGE%'andp_size%(57151823363945)andps_suppkeynot%(%s_suppkey%supplierwheres_comment%'%Customer%Complaints%')%%p_brandp_typep_size%%supplier_cntdescp_brandp_typep_size;%sum(l_extendedprice)/7.0asavg_yearly%lineitempartwherep_partkey=l_partkeyandp_brand='Brand#25'andp_container='LGPACK'andl_quantity<(%0.2*avg(l_quantity)%lineitemwherel_partkey=p_partkey)LIMIT1;%c_namec_custkeyo_orderkeyo_orderdateo_totalpricesum(l_quantity)%customerorderslineitemwhereo_orderkey%(%l_orderkey%lineitem%%l_orderkeyhavingsum(l_quantity)>100)andc_custkey=o_custkeyando_orderkey=l_orderkey%%c_namec_custkeyo_orderkeyo_orderdateo_totalprice%%o_totalpricedesco_orderdateLIMIT1;%sum(l_extendedprice*(1-l_discount))asrevenue%lineitempartwhere(p_partkey=l_partkeyandp_brand='Brand#12'andp_container%('SMCASE''SMBOX''SMPACK''SMPKG')andl_quantity>=10andl_quantity<=10+10andp_sizebetween1and5andl_shipmode%('AIR''AIRREG')andl_shipinstruct='DELIVERINPERSON')or(p_partkey=l_partkeyandp_brand='Brand#45'andp_container%('MEDBAG''MEDBOX''MEDPKG''MEDPACK')andl_quantity>=20andl_quantity<=20+10andp_sizebetween1and10andl_shipmode%('AIR''AIRREG')andl_shipinstruct='DELIVERINPERSON')or(p_partkey=l_partkeyandp_brand='Brand#24'andp_container%('LGCASE''LGBOX''LGPACK''LGPKG')andl_quantity>=30andl_quantity<=30+10andp_sizebetween1and15andl_shipmode%('AIR''AIRREG')andl_shipinstruct='DELIVERINPERSON')LIMIT1;%s_names_address%suppliernationwheres_suppkey%(%ps_suppkey%partsuppwhereps_partkey%(%p_partkey%partwherep_name%'almond%')andps_availqty>(%0.5*sum(l_quantity)%lineitemwherel_partkey=ps_partkeyandl_suppkey=ps_suppkeyandl_shipdate>=date'1995-03-01'andl_shipdate<date'1995-03-01'+interval'1'year))ands_nationkey=n_nationkeyandn_name='GERMANY'%%s_nameLIMIT1;%s_namecount(*)asnumwait%supplierlineiteml1ordersnationwheres_suppkey=l1.l_suppkeyando_orderkey=l1.l_orderkeyando_orderstatus='F'andl1.l_receiptdate>l1.l_commitdateand%(%*%lineiteml2wherel2.l_orderkey=l1.l_orderkeyandl2.l_suppkey<>l1.l_suppkey)andnot%(%*%lineiteml3wherel3.l_orderkey=l1.l_orderkeyandl3.l_suppkey<>l1.l_suppkeyandl3.l_receiptdate>l3.l_commitdate)ands_nationkey=n_nationkeyandn_name='GERMANY'%%s_name%%numwaitdescs_nameLIMIT1;%cntrycodecount(*)asnumcustsum(c_acctbal)astotacctbal%(%c_acctbal%customerwhereandc_acctbal>(%avg(c_acctbal)%customerwherec_acctbal>0.00)andnot%(%*%orderswhereo_custkey=c_custkey))ascustsale%%cntrycode%%cntrycodeLIMIT1;